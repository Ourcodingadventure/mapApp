var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:true});exports.Toast=exports.ToastRef=exports.useToast=exports.ToastProvider=void 0;var _toConsumableArray2=_interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));var _objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));var _defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _extends4=_interopRequireDefault(require("@babel/runtime/helpers/extends"));var _overlays=require("@react-native-aria/overlays");var _Transitions=require("../Transitions");var _VStack=_interopRequireDefault(require("../../primitives/Stack/VStack"));var _Alert=require("../../composites/Alert");var _react=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _IconButton=_interopRequireDefault(require("../IconButton"));var _Box=_interopRequireDefault(require("../../primitives/Box"));var _hooks=require("../../../hooks");var _Icons=require("../../primitives/Icon/Icons");var _nativeBase=require("native-base");var _this=this,_jsxFileName="/Users/suraj/Sites/projects/NativeBase/src/components/composites/Toast/Toast.tsx";var INSET=50;var POSITIONS={'top':{top:INSET,left:0,right:0},'top-right':{top:INSET,right:0},'top-left':{top:INSET,left:0},'bottom':{bottom:INSET,left:0,right:0},'bottom-left':{bottom:INSET,left:0},'bottom-right':{bottom:INSET,right:0}};var initialAnimationOffset=24;var transitionConfig={'bottom':initialAnimationOffset,'top':-initialAnimationOffset,'top-right':-initialAnimationOffset,'top-left':-initialAnimationOffset,'bottom-left':initialAnimationOffset,'bottom-right':initialAnimationOffset};var ToastContext=(0,_react.createContext)({toastInfo:{},setToastInfo:function setToastInfo(){},setToast:function setToast(){},removeToast:function removeToast(){},hideAll:function hideAll(){},isActive:function isActive(){return false;},visibleToasts:{},setVisibleToasts:function setVisibleToasts(){},hideToast:function hideToast(){}});var CustomToast=function CustomToast(){var _React$useContext=_react.default.useContext(ToastContext),toastInfo=_React$useContext.toastInfo,visibleToasts=_React$useContext.visibleToasts,removeToast=_React$useContext.removeToast;var getPositions=function getPositions(){return Object.keys(toastInfo);};return getPositions().length>0?_react.default.createElement(_overlays.OverlayContainer,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:83,columnNumber:5}},getPositions().map(function(position){if(Object.keys(POSITIONS).includes(position))return _react.default.createElement(_VStack.default,(0,_extends4.default)({margin:"auto",key:position},POSITIONS[position],{position:"absolute",space:2,alignItems:"center",justifyContent:"center",__self:_this,__source:{fileName:_jsxFileName,lineNumber:87,columnNumber:13}}),toastInfo[position].map(function(toast){return _react.default.createElement(_Transitions.PresenceTransition,{key:toast.id,visible:visibleToasts[toast.id],onTransitionComplete:function onTransitionComplete(status){if(status==='exited'){var _toast$config,_toast$config2;removeToast(toast.id);((_toast$config=toast.config)==null?void 0:_toast$config.onCloseComplete)&&((_toast$config2=toast.config)==null?void 0:_toast$config2.onCloseComplete());}},initial:{opacity:0,translateY:transitionConfig[position]},animate:{opacity:1,transition:{easing:_reactNative.Easing.ease,duration:250}},exit:{opacity:0,scale:0.85,transition:{easing:_reactNative.Easing.ease,duration:100}},__self:_this,__source:{fileName:_jsxFileName,lineNumber:100,columnNumber:19}},_react.default.createElement(_reactNative.SafeAreaView,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:124,columnNumber:21}},toast.component));}));else return null;})):null;};var ToastProvider=function ToastProvider(_ref){var children=_ref.children;var _useState=(0,_react.useState)({}),_useState2=(0,_slicedToArray2.default)(_useState,2),toastInfo=_useState2[0],setToastInfo=_useState2[1];var _useState3=(0,_react.useState)({}),_useState4=(0,_slicedToArray2.default)(_useState3,2),visibleToasts=_useState4[0],setVisibleToasts=_useState4[1];var themeProps=(0,_hooks.usePropsResolution)('Toast',{});var _useColorMode=(0,_nativeBase.useColorMode)(),colorMode=_useColorMode.colorMode;var toastIndex=_react.default.useRef(1);var hideAll=function hideAll(){setVisibleToasts({});};var hideToast=function hideToast(id){setVisibleToasts(function(prevVisibleToasts){return(0,_extends4.default)({},prevVisibleToasts,(0,_defineProperty2.default)({},id,false));});};var isActive=function isActive(id){for(var _i=0,_Object$keys=Object.keys(toastInfo);_i<_Object$keys.length;_i++){var toastPosition=_Object$keys[_i];var positionArray=toastInfo[toastPosition];return positionArray.findIndex(function(toastData){return toastData.id===id;})>-1;}return false;};var removeToast=function removeToast(id){setToastInfo(function(prev){for(var _i2=0,_Object$keys2=Object.keys(prev);_i2<_Object$keys2.length;_i2++){var toastPosition=_Object$keys2[_i2];var positionArray=prev[toastPosition];var isToastPresent=positionArray.findIndex(function(toastData){return toastData.id===id;})>-1;if(isToastPresent){var newPositionArray=positionArray.filter(function(item){return item.id!==id;});var temp={};temp[toastPosition]=newPositionArray;var newToastInfo=(0,_extends4.default)({},prev,temp);return newToastInfo;}}return prev;});};var getTextColor=function getTextColor(variant){switch(variant){case'left-accent':case'top-accent':case'subtle':return'coolGray.800';case'solid':return'warmGray.50';case'outline':case'outline-light':return colorMode==='light'?'coolGray.800':'warmGray.50';default:return'black';}};var setToast=function setToast(props){var _props$placement=props.placement,placement=_props$placement===void 0?'bottom':_props$placement,title=props.title,render=props.render,status=props.status,_props$id=props.id,id=_props$id===void 0?toastIndex.current++:_props$id,description=props.description,_props$isClosable=props.isClosable,isClosable=_props$isClosable===void 0?true:_props$isClosable,_props$duration=props.duration,duration=_props$duration===void 0?5000:_props$duration,variant=props.variant,accessibilityAnnouncement=props.accessibilityAnnouncement,_props$accessibilityL=props.accessibilityLiveRegion,accessibilityLiveRegion=_props$accessibilityL===void 0?'polite':_props$accessibilityL,rest=(0,_objectWithoutProperties2.default)(props,["placement","title","render","status","id","description","isClosable","duration","variant","accessibilityAnnouncement","accessibilityLiveRegion"]);var positionToastArray=toastInfo[placement];if(!positionToastArray)positionToastArray=[];var component=null;if(render){component=render({id:id});}else if(!status&&!variant){component=_react.default.createElement(_VStack.default,(0,_extends4.default)({space:title&&description?1:0},themeProps,rest,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:237,columnNumber:9}}),_react.default.createElement(_Box.default,{_text:themeProps._title,__self:_this,__source:{fileName:_jsxFileName,lineNumber:238,columnNumber:11}},title),description&&_react.default.createElement(_Box.default,{_text:themeProps._description,__self:_this,__source:{fileName:_jsxFileName,lineNumber:240,columnNumber:13}},description));}else if(status||variant){component=_react.default.createElement(_Alert.Alert,{maxWidth:"100%",alignSelf:"center",status:status!=null?status:'info',variant:variant,accessibilityLiveRegion:accessibilityLiveRegion,__self:_this,__source:{fileName:_jsxFileName,lineNumber:246,columnNumber:9}},_react.default.createElement(_VStack.default,{space:1,flexShrink:1,w:"100%",__self:_this,__source:{fileName:_jsxFileName,lineNumber:253,columnNumber:11}},_react.default.createElement(_nativeBase.HStack,{flexShrink:1,space:2,alignItems:"center",justifyContent:"space-between",__self:_this,__source:{fileName:_jsxFileName,lineNumber:254,columnNumber:13}},_react.default.createElement(_nativeBase.HStack,{space:2,alignItems:"center",__self:_this,__source:{fileName:_jsxFileName,lineNumber:260,columnNumber:15}},_react.default.createElement(_Alert.Alert.Icon,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:261,columnNumber:17}}),_react.default.createElement(_nativeBase.Text,{fontSize:"md",fontWeight:"medium",color:getTextColor(variant!=null?variant:'subtle'),__self:_this,__source:{fileName:_jsxFileName,lineNumber:262,columnNumber:17}},title)),isClosable?_react.default.createElement(_IconButton.default,{variant:"unstyled",icon:_react.default.createElement(_Icons.CloseIcon,{size:"3",color:getTextColor(variant!=null?variant:'subtle'),__self:_this,__source:{fileName:_jsxFileName,lineNumber:274,columnNumber:21}}),onPress:function onPress(){return hideToast(id);},__self:_this,__source:{fileName:_jsxFileName,lineNumber:271,columnNumber:17}}):null),_react.default.createElement(_Box.default,{px:"6",_text:{color:getTextColor(variant!=null?variant:'subtle')},__self:_this,__source:{fileName:_jsxFileName,lineNumber:283,columnNumber:13}},description)));}toastInfo[placement]=[].concat((0,_toConsumableArray2.default)(positionToastArray),[{component:component,id:id,config:props}]);setToastInfo((0,_extends4.default)({},toastInfo));setVisibleToasts((0,_extends4.default)({},visibleToasts,(0,_defineProperty2.default)({},id,true)));if(duration!==null){setTimeout(function(){hideToast(id);},duration);}if(accessibilityAnnouncement&&_reactNative.Platform.OS==='ios'){_reactNative.AccessibilityInfo.announceForAccessibility(accessibilityAnnouncement);}return id;};return _react.default.createElement(ToastContext.Provider,{value:{toastInfo:toastInfo,setToastInfo:setToastInfo,setToast:setToast,removeToast:removeToast,hideAll:hideAll,isActive:isActive,visibleToasts:visibleToasts,setVisibleToasts:setVisibleToasts,hideToast:hideToast},__self:_this,__source:{fileName:_jsxFileName,lineNumber:320,columnNumber:5}},children,_react.default.createElement(CustomToast,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:334,columnNumber:7}}));};exports.ToastProvider=ToastProvider;var useToast=function useToast(){var _React$useContext2=_react.default.useContext(ToastContext),setToast=_React$useContext2.setToast,hideAll=_React$useContext2.hideAll,isActive=_React$useContext2.isActive,hideToast=_React$useContext2.hideToast;var toast={show:setToast,close:hideToast,closeAll:hideAll,isActive:isActive};return toast;};exports.useToast=useToast;var ToastRef=_react.default.createRef();exports.ToastRef=ToastRef;var Toast={show:function show(props){var _ToastRef$current;return(_ToastRef$current=ToastRef.current)==null?void 0:_ToastRef$current.show(props);},close:function close(id){var _ToastRef$current2;return(_ToastRef$current2=ToastRef.current)==null?void 0:_ToastRef$current2.close(id);},closeAll:function closeAll(){var _ToastRef$current3;return(_ToastRef$current3=ToastRef.current)==null?void 0:_ToastRef$current3.closeAll();},isActive:function isActive(id){var _ToastRef$current4;return(_ToastRef$current4=ToastRef.current)==null?void 0:_ToastRef$current4.isActive(id);}};exports.Toast=Toast;
//# sourceMappingURL=Toast.js.map